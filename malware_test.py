import requests
try:
    req = requests.get('https://curben.gitlab.io/malware-filter/urlhaus-filter-domains.txt')
    try:
        with open("cache_malware.txt","w") as f:
            f.write(req.text)
            f.close()
    except Exception as err:
        print("Error in saving to cache:{}".format(err))
    filterList = req.text.split("\n")
except Exception as err:
    print("Error in loading malware lists. Using cache...")
    try:
        with open("cache_malware.txt") as f:
            filterList = f.read().split("\n")
            f.close()
    except Exception as err2:
        print("Error in loading cache: {}\n Using default...".format(err2))
        filterList = []
def checkHost(host):
    match1 = False
    for url in filterList:
        if url.startswith("!"):
            continue
        if url == host:
            #print("Url is malware")
            match1 = True
            break
    if match1 == False:
        if host in filterList:
            return True
        else:
            return False
    else:
        return match1 